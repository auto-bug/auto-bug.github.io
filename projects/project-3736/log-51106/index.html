
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Obstacle Avoidance - deshipu.art</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
  
     
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="icon" type="image/png" href="../../../_static/favicon.png">

  
  <link rel="alternate" type="application/atom+xml"  href="../../../blog/atom.xml" title="deshipu.art">
  

  </head><body>
<div id="topbar">
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
    <div id="logo"><a href="../../../">
        <img
            src="/_static/logo.png"
            alt=""
        />deshipu.art</a></div>
</div>

<div role="main">
  <section id="obstacle-avoidance">
<h1>Obstacle Avoidance<a class="headerlink" href="#obstacle-avoidance" title="Permalink to this heading">¶</a></h1>
<p>Published on 2017-01-01 in <span class="xref std std-ref">project-3736</span>.</p>
<p>All that was left was writing the code, and testing it. And making
some corrections, and testing them. And fine-tuning some parameter,
and testing. And then a little bit of testing.</p>
<p>All this time I was programming the robot using my programming clip.
Unfortunately, it became a bit loose, so I had to hold it in place
with my hand while programming, so it was a little inconvenient.
Because of the placement of the chip, I also had to remove at least
one leg every time I wanted to program it, and I had to disconnect the
servos, as they take too much power and make the computer shut down
the USB port. In the end, it was a lot of reprogramming, and I wish I
had broken out the programming interface in some more convenient way.
Oh well.</p>
<p>During testing, I also connected a piezo speaker to the last unused
pin, and bit-banged beeps on it (it’s not a timer pin, so couldn’t do
PWM, I guess something to consider for the next version). That helped
in debugging a lot, since I could place different beeps in different
places in the program, and I would know where the robot was. Since
they were primitively bit-banged, the robot also paused while beeping,
which let me see better the different phases of its movement.</p>
<p>At some point I decided to get rid of the old feed, and made new ones,
out of an expired public transportation card. I also painted the new
feet with liquid rubber, to give them a better grip.</p>
<img alt="projects/project-3736/images/9499261483281935973.jpg" src="projects/project-3736/images/9499261483281935973.jpg" />
<p>You can also see on this photo, that I went back to the old battery.
It fits in the hat, and it has a much better C value. I decided to not
include the battery charger module in the robot this time – you have
to disconnect the battery for charging.</p>
<iframe style="width: 500px; height: 281px;" width="500" height="281" frameborder="0" allowfullscreen="None" src="https://www.youtube.com/embed/S6yyWpflXrM"></iframe>
<p>Finally, a video of the robot doing its thing. It checks the distance
at every step, at the moment when the body is horizontal. I used the
fact that with each step it’s looking in a different direction, and I
made it choose the direction of the turn based on that. Oh, I also
sped up the final version of the code. Unfortunately, I had to remove
the beeping code to make it all fit in 1kB for the challenge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AVR</span> <span class="n">Memory</span> <span class="n">Usage</span>
<span class="o">----------------</span>
<span class="n">Device</span><span class="p">:</span> <span class="n">attiny85</span>

<span class="n">Program</span><span class="p">:</span>    <span class="mi">1006</span> <span class="nb">bytes</span> <span class="p">(</span><span class="mf">12.3</span><span class="o">%</span> <span class="n">Full</span><span class="p">)</span>
<span class="p">(</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="o">.</span><span class="n">bootloader</span><span class="p">)</span>

<span class="n">Data</span><span class="p">:</span>         <span class="mi">19</span> <span class="nb">bytes</span> <span class="p">(</span><span class="mf">3.7</span><span class="o">%</span> <span class="n">Full</span><span class="p">)</span>
<span class="p">(</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="o">.</span><span class="n">bss</span> <span class="o">+</span> <span class="o">.</span><span class="n">noinit</span><span class="p">)</span>

</pre></div>
</div>
<p>The walking code turned out to be much larger than I expected – even
though it’s mostly just calling a single function with three 16-bit
integer parameters. I guess I could scale them down to bytes to save
some space…</p>
</section>


</div>
  </body>
</html>